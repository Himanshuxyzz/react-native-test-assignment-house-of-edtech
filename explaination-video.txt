https://drive.google.com/file/d/1KFXLLZN7ApOUcoTWKueD6Y0_-AQ0B_ng/view?usp=drivesdk

# Picture-in-Picture (PiP) in expo-video

PiP mode allows users to continue watching video in a small, floating window while navigating away from the player or outside the app.

## 1. Setup & Configuration
To use PiP, you must first configure the `expo-video` plugin in your `app.json` or `app.config.js`:

```json
{
  "expo": {
    "plugins": [
      [
        "expo-video",
        {
          "supportsPictureInPicture": true,
          "supportsBackgroundPlayback": true
        }
      ]
    ]
  }
}
```
*Note: Your project already has this configuration.*

## 2. Code Implementation
PiP is controlled via the `VideoView` component using props and methods.

### Props (VideoView)
- `allowsPictureInPicture`: (Boolean) Enables the native PiP button/gesture support.
- `startsPictureInPictureAutomatically`: (Boolean) Automatically enters PiP when the user backgrounds the app (Android 12+, iOS).
- `onPictureInPictureStart`: Callback triggered when PiP starts.
- `onPictureInPictureStop`: Callback triggered when PiP stops.

### Methods (via VideoView Ref)
You can trigger PiP programmatically using a ref to the `VideoView`:

```tsx
const videoViewRef = useRef<VideoView>(null);

// To enter PiP
videoViewRef.current?.startPictureInPicture();

// To exit PiP
videoViewRef.current?.stopPictureInPicture();
```

### Support Check
Always check if the device supports PiP before trying to start it:

```tsx
import { isPictureInPictureSupported } from 'expo-video';

if (isPictureInPictureSupported()) {
  // Safe to use PiP
}
```

## 3. Platform Specifics
- **iOS**: Requires `audio` background mode (handled by config plugin). PiP usually requires the video to be playing or "ready to play".
- **Android**: Supports PiP natively. Transitions are smooth if "auto-enter" is enabled.
- **Web**: Supported in major browsers via the standard PiP API.